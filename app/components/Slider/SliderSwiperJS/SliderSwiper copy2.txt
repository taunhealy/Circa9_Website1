// SliderSwiper.tsx
"use client";

import React, { useRef, useState } from "react";
import Categories from "../../Categories";
import "./sliderswiper.scss";

interface Item {
  id: number;
  title: string;
  img: string;
  date: string;
  category: string;
  price: number;
  desc?: string;
  director?: string;
  producer?: string;
  cinematographer?: string;
}

interface SliderProps {
  items: Item[];
}

const SliderSwiper: React.FC<SliderProps> = ({ items }) => {
  const sortingRef = useRef<HTMLDivElement>(null);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [filteredItems, setFilteredItems] = useState<Item[]>(items);

  const handleCategoryChange = (newFilteredItems: Item[]) => {
    setFilteredItems(newFilteredItems);
    // Reset the current index to 0 when the category changes
    setCurrentIndex(0);
  };

  

  const handleNextItem = () => {
    setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredItems.length);
  };

  const handlePrevItem = () => {
    setCurrentIndex(
      (prevIndex) =>
        (prevIndex - 1 + filteredItems.length) % filteredItems.length
    );
  };

  return (
    <>
      <div ref={sortingRef}>
        <section className="item-background-container">
          {filteredItems.length > 0 && (
            <div key={filteredItems[currentIndex].id} className="item-wrapper">
              <div className="item-thumbnail-container">
                <img
                  className="item-thumbnail-image"
                  src={filteredItems[currentIndex].img}
                  alt={filteredItems[currentIndex].title}
                />
              </div>
              <section className="item-titles">
                <div className="brand-title">
                  {filteredItems[currentIndex].category}
                </div>
                <div className="item-title">
                  {filteredItems[currentIndex].title}
                </div>
              </section>
              {/* ... rest of your item rendering code ... */}
            </div>
          )}
        </section>
        <section className="brand-sidebar">
          <Categories
            itemsData={items}
            onCategoryChange={handleCategoryChange}
          />
        </section>
        <div className="nextprev-button-wrapper">
          <button onClick={handlePrevItem}>prev</button>
          <button onClick={handleNextItem}>next</button>
          
        </div>
      </div>
      
    </>
  );
};

export default SliderSwiper;
